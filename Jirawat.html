<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/menu.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <title>COVID-19</title>
</head>
<body>
    <div style=" position: absolute; width: 100%; padding-top: -35px;">
        <div style=" display: flex; justify-content: flex-end;">
             <div class="circle" style="background-color: #FF6161;"></div>
             <h5>Update date</h5>
             <div style="width: 10px;"></div>
             <h5 id="Update_date" >2021-11-03  07:30:52</h5>
             <div style="width: 20px;"></div>
        </div>
    </div>
    <nav role="navigation">
        <div id="menuToggle" style="margin-left:20px;">
          <input type="checkbox" />
          <span></span>
          <span></span>
          <span></span>
          <ul id="menu">
            <a href="today.html"><li>รายงานสถานการณ์ COVID-19 ประจำวัน</li></a>
            <a href="Napakorn.html"><li>รายงานสถานการณ์ COVID-19 ประจำวัน แยกตามรายจังหวัด</li></a>
            <a href="peerapon.html"><li>ข้อมูลผู้ป่วยประจำวัน(Line Lists)</li></a>
            <a href="Napath.html"><li>รายงานสถานการณ์ COVID-19 ระลอก 3 </li></a>
            <a href="todayByProvince.html"><li>รายงานสถานการณ์ COVID-19 ระลอก 3 แยกตามรายจังหวัด</li></a>
            <a href="warin.html"><li>ข้อมูลผู้ป่วยระลอก 3 </li></a>
            <a href="Suphon.html"><li>ข้อมูลผู้ป่วยระลอก 1 ถึงระลอก 2</li></a>
            <a href="Jirawat.html"><li>รายงานสถานการณ์ COVID-19 ระลอก 1 ถึงระลอก 2 </li></a>
            <a href="todayByProvince copy.html"><li>รายงานสถานการณ์ COVID-19 ระลอก 1 ถึงระลอก 2  แยกตามรายจังหวัด</li></a>
            <a href="Maytaphon.html"><li>รายงานสถานการณ์ COVID-19 ประจำวัน แยกตามรายจังหวัด</li></a>
            <a href="kungthai.html"><li>รายงานสถานการณ์ COVID-19 ประจำวัน</li></a>
          </ul>
        </div>
      </nav>
      <main>
        <div style="height: 31px;"></div>
        <img style="height: 100%; width: 100%; " src="../images/logo.png">
        <article style="padding-left: 160px; padding-right: 160px;">
            <div id="box" style=" margin-top: 5px; padding: 50px; padding-top: 10px;  background-color: #093D52;">
                <h2 style="text-align: center; font-size: 31px; margin-bottom: 17px;">ข้อมูลผู้ป่วยระลอก 1 ถึงระลอก 2 (ตั้งแต่ 12/01/2020 – 31/03/2021)</h2>
              <div style="width: 100%; display: flex; justify-content: right; margin-bottom: 17px; ">
                  <div style="width: 10px;"></div>
                  <div style="width: 10px;"></div>
                  <input id="D_Date" type="date" value="2020-01-12" style="border-radius: 6px; width: 130px; height: 30px; padding-left: 10px;" >
                  <div style="width: 10px;"></div>
                  <button style="background-color: #00000026; background-color:white; width: 80px; border-radius: 6px;" onclick="onClicks()">ตกลง</button>
              </div>

              <div style="width: 100%;">
                <div>
                    <div>
                        <table id="tableData" style="width: 100%;">
                            <tr style="background-color: #419184">
                                <td>NO</td>
                                <td>SEX</td>
                                <td>AGE</td>
                                <td>NATIONALITY</td>
                                <td>JOB</td>
                                <td>RISK</td>
                                <td>PATIENT_TYPE</td>
                                <td>PROVINCE</td>
                            </tr>
                    </table>
                    </div>
                    <br>
                    <br>
                    <br>
                    <div style="width: 100%; text-align: center;">
                        <h2>แผนภูมิแสดงค่าเฉลี่ยอายุจำนวนผู้ป่วยระลอก 1 ถึงระลอก 2</h2>
                    </div>
                    <div id="donutchart" style="width: 600px; height: 500px; "></div>
              </div>
            </div>  
            </div>
         <div style="height: 20px;"></div>   
        </article>
        <footer  style="display: flex; justify-content: space-between; width: 100%; height: 160px; background-color: #171B29; padding-top: 15px; padding-bottom: 10px; ">
            <div style=" margin-left: 50px;">
                <img src="../images/icon.png" style="width: 60px; margin-left: 10px;">
                <div style="height: 10px;"></div>
                <div style="font-size: 18px;">กรมควบคุมโรค</div>
                <div style="height: 5px;"></div>
                <div style="width: 289px; font-size: 16px; font-family: CloudLight;">ที่อยู่: 88/21 ถนน ติวานนท์ ตำบลตลาดขวัญ  อำเภอเมือง จังหวัดนนทบุรี 11000</div>
            </div>
            <div style="margin-right: 20px;">
                <div style="height: 99px"></div>
                <div style="font-size: 18px;">60030016 จิระวัฒน์ ไชยรงฆ์ศรี</div>
                <div style="font-size: 18px;">60030016@kmitl.ac.th</div>
            </div>
        </footer>
      </main>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
var data; var a1 =0,a2 =0,a3=0,a4=0,a5=0,a6=0,a7=0;
(function () {
    `use strict`;
    var Date = document.getElementById("Update_date");
    $.ajax({
        dataType: "json",
        url: 'https://jirawat1707.github.io/Covid-19-Data/round-1to2-line-lists.json',
        success: function(response) {
           Date.textContent = response[0]['txn_date'];
           var i = 0;
           data = response;
           for (index in response){
             if(response[index]["age_range"] == "< 10 ปี") { a1 = a1 +1;}
        else if(response[index]["age_range"] == "10-19 ปี") { a2++;}
        else if(response[index]["age_range"] == "20-29 ปี") { a3++;}
        else if(response[index]["age_range"] == "30-39 ปี") { a4++;}
        else if(response[index]["age_range"] == "40-49 ปี") { a5++;}
        else if(response[index]["age_range"] == "50-59 ปี") { a6++;}
        else{ a7++; }
             if((response[index]["txn_date"] == "12/1/2020")){
               i++;
              document.getElementById("tableData").innerHTML += 
              `<tr class="trWhite">
                    <td>${i}</td>
                    <td>${response[index]["gender"]}</td>
                    <td>${response[index]["age_number"]}</td>
                    <td>${response[index]["nationality"]}</td>
                    <td>${response[index]["job"] ?? '-'}</td>
                    <td>${response[index]["risk"]}</td>
                    <td>${response[index]["patient_type"]}</td>
                    <td>${response[index]["province"]}</td>
              </tr>`;
             }
           }
    google.charts.load("current", {packages:["corechart"]});
    google.charts.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Task', 'Hours per Day'],
          ['น้อยกว่า 10 ปี', a1],
          ['10 ถึง 19 ปี', a2],
          ['20 ถึง 29 ปี', a3],
          ['30 ถึง 39 ปี', a4],
          ['40 ถึง 49 ปี', a5],
          ['50 ถึง 59 ปี', a6],
          ['มากกว่า 60 ปี', a7],
        ]);
        var options = {
          title: '',
          pieHole: 0.6,
          pieHoleColor: 'white',
          chartArea: {width: "100%", height: "100%", 
                bottom: 0, left: 70, 
                top: 0, 
                backgroundColor: {
                    fill: 'white',
                },
            },
            backgroundColor: {
                fill: 'transparent',
            },
            legend: {position: 'right', alignment: 'center' , textStyle: {color: 'white', fontSize: 16}},
            hAxis: {textStyle: {color: 'white'}},
            vAxis: {textStyle: {color: 'white'}},
        };

        var chart = new google.visualization.PieChart(document.getElementById('donutchart'));
        chart.draw(data, options);
      }
    
        }
    });
})();    
function onClicks(){
    var D_Date = document.getElementById('D_Date').value;
    var d = parseInt(D_Date.split("-")[1]);
    var m = parseInt(D_Date.split("-")[2]);
    var y = parseInt(D_Date.split("-")[0]);
    var s ;
    s = m+'/'+d+'/'+y;
    var i = 0;
    document.getElementById("tableData").innerHTML =  `
    <tr style="background-color: #419184">
          <td>NO</td>
          <td>SEX</td>
          <td>AGE</td>
          <td>NATIONALITY</td>
          <td>JOB</td>
          <td>RISK</td>
          <td>PATIENT_TYPE</td>
          <td>PROVINCE</td>
    </tr>
    `;
    console.log(s);
      for (index in data){
        if((data[index]["txn_date"] == s)){
          i++;
        document.getElementById("tableData").innerHTML += 
              `<tr class="trWhite">
                    <td>${i}</td>
                    <td>${data[index]["gender"]}</td>
                    <td>${data[index]["age"]}</td>
                    <td>${data[index]["nationality"]}</td>
                    <td>${data[index]["job"] ?? '-'}</td>
                    <td>${data[index]["risk"]}</td>
                    <td>${data[index]["patient_type"]}</td>
                    <td>${data[index]["province"]}</td>
              </tr>`;
      }
    }
}   
    </script>
      
</body>